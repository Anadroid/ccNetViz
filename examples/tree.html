<!DOCTYPE html>
<html>
<head>
  <title>ccNetViz tree layout example</title>
  <style type="text/css">
    #body, canvas {
      width: 500px;
      height: 500px;
    }
    
    #body {
      display: inline-block;
    }
    
    #info {
/*      float: right;*/
    }
  </style>
  <script src="./libs/jquery.min.js"></script>
  <script src="../dist/ccNetViz.js"></script>
</head>
<body>
  <h1>Tree layout example</h1>
  <div id='body'>
  </div>
  <div id='info' />
    <select id='listExamples'></select>
    <div id='report'>
      Nodes: <span id='nodesCnt'></span><br />
      Edges: <span id='edgesCnt'></span><br />
      Rendered in <span id='renderedIn'></span>ms<br />
    </div>
  </div>
  <script>
  
    var examples = 'tree1.json,banana.json'.split(',');
    
    function init(){
      function onChange(e){
        var v = $(this).val();
        
        $.ajax({url: 'data/'+v, dataType: 'json'}).done(showGraph);
      }
    
      //fill in graph names
      var select = $("#listExamples");
      $.each(examples, function(index,val){
        select.append($("<option />", {'value': val}).text(val));
      });
      select.change(onChange);
      
      //init graph with currently selected data
      onChange.call(select);
    };

    var graph;
    var el;
    function showGraph(data){
      adata = data;
      if(el)
        el.parentNode.removeChild(el);
      document.getElementById("body").appendChild(el = document.createElement("canvas"));

      var startTime = new Date();

      if(graph) graph.remove();	//if there was an old graph, remove its handlers from DOM content

      graph = new ccNetViz(el, {
	styles: {
	  node: { texture: "images/node.png", label: { hideSize: 16 } },
	  node: { label: { hideSize: 16 } },
	  edge: { arrow: { texture: "images/arrow.png" } }
	}});
      graph.set(data.nodes, data.edges, "tree");
      console.log("antes do draw");
      graph.draw();
      console.log("depois do draw");
      
      $('#nodesCnt').text(data.nodes.length);
      $('#edgesCnt').text(data.edges.length);
      $('#renderedIn').text(Math.round((new Date().getTime() - startTime.getTime())*10)/10);
    }

    $(init);
  </script>
</body>
</html>
